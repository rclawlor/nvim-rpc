use rmpv::Value;

use crate::api::*;
use crate::value_vec;
use crate::error::Error;


/// The below implementations are autogenerated using the Neovim API
impl {{name}} {
    {{#each functions}}
    /// Since: {{since}}
    pub fn {{name}}(&mut self{{#each parameters}}, {{this.name}}: {{{as_type this.parameter_type}}}{{/each}}) -> Result<{{{as_type return_type}}}, Error> {
        {{#if (no_ret return_type)}}let ret = {{/if}}self.session.call(
            "{{@root.prefix}}{{name}}",
            value_vec!(self.data{{#if parameters.[0]}}, {{/if}}{{#each parameters}}{{this.name}}{{#unless @last}}, {{/unless}}{{/each}})
        )?;
        {{#if (no_ret return_type)}}
        Ok(ret{{generate_return return_type }})
        {{else}}
        Ok(())
        {{/if}}
    }
    {{#unless @last}}

    {{/unless}}
    {{/each}}
}

